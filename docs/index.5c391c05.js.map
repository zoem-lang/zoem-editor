{"mappings":"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","sources":["src/js/scripts.js"],"sourcesContent":["import { view } from './codemirror/setup.js';\r\n\r\nconst navToggle = document.querySelector(\".navToggle\"),\r\n  nav = document.querySelector(\".nav\"),\r\n  menuHeaderBtns = document.querySelectorAll(\".nav__item > button\"),\r\n  menuBtns = document.querySelectorAll(\".nav__dropdown-item > button\"),\r\n  filenameTitle = document.querySelector(\".filename-title\"),\r\n  exampleBtns = document.querySelectorAll(\".example-item button\"),\r\n  regex = document.querySelector(\".regex\");\r\nlet isMenuOpen = false;\r\n\r\n// MENU HEADERS\r\n\r\nfunction onMenuHeaderClick(e) {\r\n  e.preventDefault();\r\n  let btn = e.currentTarget;\r\n  isMenuOpen = btn.parentElement.classList.toggle(\"nav__item--open\");\r\n}\r\n\r\nfunction onMenuHeaderMouseover(e) {\r\n  e.preventDefault();\r\n  let btn = e.currentTarget;\r\n  if (isMenuOpen) {\r\n    for (let b of menuHeaderBtns) {\r\n      b.parentElement.classList.remove(\"nav__item--open\");\r\n    }\r\n    btn.parentElement.classList.add(\"nav__item--open\");\r\n    btn.focus();\r\n  }\r\n}\r\n\r\nfunction onMenuHeaderBlur(e) {\r\n  // e.preventDefault();\r\n  // let btn = e.currentTarget;\r\n  // btn.parentElement.classList.remove(\"nav__item--open\");\r\n}\r\n\r\n// MENU BTNS\r\n\r\nfunction onMenuBtnClick(e) {\r\n  e.preventDefault();\r\n  isMenuOpen = false;\r\n  let btn = e.currentTarget;\r\n  btn.parentElement.parentElement.parentElement.classList.remove(\"nav__item--open\");\r\n}\r\n\r\nfunction newFile() {\r\n  setDoc(\"\");\r\n  filenameTitle.innerText = \"Untitled\";\r\n}\r\n\r\nfunction loadFile() {\r\n  const input = document.createElement(\"input\");\r\n  input.type = \"file\";\r\n  input.accept = \".zoem,.txt\";\r\n  input.addEventListener(\"input\", e => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      const reader = new FileReader();\r\n      reader.addEventListener(\"load\", () => {\r\n        const result = reader.result;\r\n        setDoc(result);\r\n        const SEPARATOR = \".\";\r\n        const filenameParts = file.name.split(SEPARATOR);\r\n        const filename = filenameParts.slice(0, filenameParts.length - 1).join(SEPARATOR);\r\n        filenameTitle.innerText = filename;\r\n      }, false);\r\n      reader.readAsText(file, \"UTF-8\");\r\n    }\r\n  });\r\n  input.click();\r\n}\r\n\r\nfunction saveFile() {\r\n  const text = view.state.doc.toString();\r\n  const blob = new Blob([text], { type: \"text/plain;charset=UTF-8\" });\r\n  const url = URL.createObjectURL(blob);\r\n  const a = document.createElement(\"a\");\r\n  a.href = url;\r\n  const title = filenameTitle.innerText;\r\n  a.download = `${title}.zoem`;\r\n  a.click();\r\n}\r\n\r\nfunction loadExample(e) {\r\n  let filename = e.currentTarget.value;\r\n  load(filename);\r\n}\r\n\r\nfunction load(filename) {\r\n  const path = \"./examples/\" + filename + \".zoem\";\r\n  fetch(path)\r\n  .then(r => r.text())\r\n  .then((code) => {\r\n    setDoc(code);\r\n    filenameTitle.innerText = filename;\r\n  })\r\n  .catch(err => console.log(err));\r\n}\r\n\r\nfunction openPopup(e) {\r\n  regex.classList.add(\"visible\");\r\n}\r\n\r\nfunction closePopup(e) {\r\n  regex.classList.remove(\"visible\");\r\n}\r\n\r\n// ECHO\r\n\r\nfunction handleError(e, source = \"\") {\r\n  if (!e) return null;\r\n  console.error(e);\r\n  const { oneLiner, preErrorSection, errorSection, postErrorSection } = formatZoemError(e, source);\r\n  let errorStr = oneLiner;\r\n  if (errorSection) {\r\n    errorStr += '<br />';\r\n    errorStr += `${preErrorSection}<span class=\"error\">${errorSection}</span>${postErrorSection}`;\r\n  }\r\n}\r\n\r\nfunction echo() {\r\n  // https://github.com/danman113/YALI.js/blob/master/browser.js\r\n  const source = view.state.doc.toString();\r\n  console.log(source);\r\n  const browserEnv = new Environment();\r\n  try {\r\n    // run(source, browserEnv, handleOutput);\r\n    let echo = run(source, browserEnv);\r\n    setDoc(echo);\r\n    handleError(null);\r\n  } catch (e) {\r\n    handleError(e, source);\r\n  }\r\n}\r\n\r\n// CHARACTER INPUT\r\n\r\nfunction insert(str) {\r\n  view.dispatch(view.state.replaceSelection(str));\r\n  view.focus();\r\n}\r\n\r\nfunction setDoc(str) {\r\n  view.dispatch({ changes: { from: 0, to: view.state.doc.length, insert: str } });\r\n  view.focus();\r\n}\r\n\r\n// MAIN\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n  load(\"docks\");\r\n\r\n  // nav\r\n  navToggle.addEventListener(\"click\", e => {\r\n    e.preventDefault();\r\n    if (nav.classList.toggle(\"open\")) {\r\n      navToggle.innerText = \"×\";\r\n    } else {\r\n      navToggle.innerText = \"☰\";\r\n    }\r\n    document.body.classList.toggle(\"navIsOpen\");\r\n  });\r\n\r\n  // menu headers\r\n  menuHeaderBtns.forEach(btn => {\r\n    btn.addEventListener(\"click\", onMenuHeaderClick);\r\n    btn.addEventListener(\"mouseover\", onMenuHeaderMouseover);\r\n    btn.addEventListener(\"blur\", onMenuHeaderBlur);\r\n  });\r\n\r\n  // menu buttons\r\n  menuBtns.forEach(btn => {\r\n    btn.addEventListener(\"click\", onMenuBtnClick);\r\n  })\r\n\r\n  // file buttons\r\n  document.querySelector(\"#newBtn\").addEventListener(\"click\", newFile);\r\n  document.querySelector(\"#loadBtn\").addEventListener(\"click\", loadFile);\r\n  document.querySelector(\"#saveBtn\").addEventListener(\"click\", saveFile);\r\n  \r\n  // examples\r\n  exampleBtns.forEach(btn => {\r\n    btn.addEventListener(\"click\", loadExample);\r\n  });\r\n\r\n  // regex\r\n  document.querySelector(\"#regexBtn\").addEventListener(\"click\", openPopup);\r\n  document.querySelector(\".backdrop\").addEventListener(\"click\", closePopup);\r\n\r\n  // echo\r\n  document.querySelector(\"#echoBtn\").addEventListener(\"click\", echo);\r\n\r\n  // character input\r\n  document.querySelector(\"#clearBtn\").addEventListener(\"click\", () => setDoc(\"\"));\r\n  document.querySelector(\"#commentBtn\").addEventListener(\"click\", () => insert(\"† \"));\r\n  document.querySelector(\"#dashBtn\").addEventListener(\"click\", () => insert(\"—\"));\r\n  document.querySelector(\"#colonBtn\").addEventListener(\"click\", () => insert(\":\"));\r\n  document.querySelector(\"#ampersandBtn\").addEventListener(\"click\", () => insert(\"&\"));\r\n  document.querySelector(\"#openQuoteBtn\").addEventListener(\"click\", () => insert(\"“\"));\r\n  document.querySelector(\"#closeQuoteBtn\").addEventListener(\"click\", () => insert(\"”\"));\r\n  document.querySelector(\"#pipeBtn\").addEventListener(\"click\", () => insert(\"|\"));\r\n  document.querySelector(\"#openParenBtn\").addEventListener(\"click\", () => insert(\"(\"));\r\n  document.querySelector(\"#closeParenBtn\").addEventListener(\"click\", () => insert(\")\"));\r\n  document.querySelector(\"#questionBtn\").addEventListener(\"click\", () => insert(\"?\"));\r\n  document.querySelector(\"#asteriskBtn\").addEventListener(\"click\", () => insert(\"*\"));\r\n  document.querySelector(\"#plusBtn\").addEventListener(\"click\", () => insert(\"+\"));\r\n});\r\n\r\ndocument.addEventListener(\"keydown\", e => {\r\n  if (e.code === \"Escape\" && regex.classList.contains(\"visible\")) {\r\n    regex.classList.remove(\"visible\");\r\n  }\r\n});"],"names":["$8BrLS","parcelRequire","$c5788eb2e609bbc3$var$navToggle","document","querySelector","$c5788eb2e609bbc3$var$nav","$c5788eb2e609bbc3$var$menuHeaderBtns","querySelectorAll","$c5788eb2e609bbc3$var$menuBtns","$c5788eb2e609bbc3$var$filenameTitle","$c5788eb2e609bbc3$var$exampleBtns","$c5788eb2e609bbc3$var$regex","$c5788eb2e609bbc3$var$isMenuOpen","$c5788eb2e609bbc3$var$onMenuHeaderClick","e","preventDefault","btn","currentTarget","parentElement","classList","toggle","$c5788eb2e609bbc3$var$onMenuHeaderMouseover","b","remove","add","focus","$c5788eb2e609bbc3$var$onMenuHeaderBlur","$c5788eb2e609bbc3$var$onMenuBtnClick","$c5788eb2e609bbc3$var$newFile","$c5788eb2e609bbc3$var$setDoc","innerText","$c5788eb2e609bbc3$var$loadFile","input","createElement","type","accept","addEventListener","file","target","files","reader","FileReader","result","filenameParts","name","split","filename","slice","length","join","readAsText","click","$c5788eb2e609bbc3$var$saveFile","text","view","state","doc","toString","blob","Blob","url","URL","createObjectURL","a","href","title","download","$c5788eb2e609bbc3$var$loadExample","$c5788eb2e609bbc3$var$load","value","fetch","then","r","code","catch","err","console","log","$c5788eb2e609bbc3$var$openPopup","$c5788eb2e609bbc3$var$closePopup","$c5788eb2e609bbc3$var$handleError","source","error","oneLiner","preErrorSection","errorSection","postErrorSection","formatZoemError","errorStr","$c5788eb2e609bbc3$var$echo","browserEnv","Environment","run","$c5788eb2e609bbc3$var$insert","str","dispatch","replaceSelection","changes","from","to","insert","body","forEach","contains"],"version":3,"file":"index.5c391c05.js.map"}